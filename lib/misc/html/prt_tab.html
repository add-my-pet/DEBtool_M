
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>prt_tab</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-04-05"><meta name="DC.source" content="prt_tab.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>prt_tab</h1><!--introduction--><p>writes table to temporary file tab.html, shows it in the bowser and deletes it</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#3">Syntax</a></li><li><a href="#4">Description</a></li><li><a href="#5">Remarks</a></li><li><a href="#6">Example of use</a></li></ul></div><h2 id="3">Syntax</h2><p><a href="../prt_tab.m"><b>prt_tab</b></a> (values, header, title, save)</p><h2 id="4">Description</h2><p>writes table to temporary file tab.html, shows it in the bowser and deletes it</p><h2 id="5">Remarks</h2><p>The input might be any sequence of cell arrays and matrices, but all must have the same number of rows. The header is not optional, but if empty, no header is printed.</p><h2 id="6">Example of use</h2><p>prt_tab({{'aa';'bb';'cc'}, [1.1 2 3; 4 5 6; 7 8 9.3]},{'nm','v1','v2','v3'})</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% prt_tab
% writes table to temporary file tab.html, shows it in the bowser and deletes it

%%
function prt_tab(values, header, title, save)
% created 2021/05/11 by Bas Kooijman

%% Syntax
% <../prt_tab.m *prt_tab*> (values, header, title, save) 

%% Description
% writes table to temporary file tab.html, shows it in the bowser and deletes it

%
% Input:
%
% * varargin: cell arrays with strings and/or matrices with numbers
% * header: cell vector with strings for header; length should match number of columns, but might by empty
% * title: optional string with title of browser tab
% * save: optional boolean to save the html-file (default: false)
%
% Output:
%
% * no Malab output, tab.html is written, shown in browser and deleted

%% Remarks
% The input might be any sequence of cell arrays and matrices, but all must have the same number of rows.
% The header is not optional, but if empty, no header is printed.

%% Example of use
% prt_tab({{'aa';'bb';'cc'}, [1.1 2 3; 4 5 6; 7 8 9.3]},{'nm','v1','v2','v3'})
  
  if ~exist('header','var')
    header = {};
  end
  if ~exist('title','var')
    title = 'table';
  end
  if ~exist('save','var')
    save = false;
  end

  if size(values,2)>1 && ischar(values{1}) && iscell(values(2))
    values{1} = select(values{1}); % the assumption is that values{1} is the name of a taxon, which is replaced by names of entries
  end
  
  n_rows = size(values{1},1);
  N = size(values,2); val = cell(n_rows,0);
  try
    for j=1:N
      if iscell(values{j})
        val = [val,values{j}];
      else
        val = [val, arrayfun(@num2str, values{j}, 'UniformOutput', 0)];
      end
    end
    n_cols = size(val, 2);
  catch
    fprintf('Warning from prt_tab: table components do not all have the same number of rows\n');
    return
  end
 
  if ~isempty(header) && ~n_cols == length(header)
    fprintf('Warning from prt_tab: length of header does not match number of collums\n');
    return
  end
        
  fileName = [title, '.html']; % char string with file name of output file
  oid = fopen(fileName, 'w+'); % open file for writing, delete existing content

  % file head
  fprintf(oid, '<!DOCTYPE html>\n');
  fprintf(oid, '<html>\n');
  fprintf(oid, '<head>\n');
  fprintf(oid, '  <title>%s</title>\n',  title);
  fprintf(oid, '  <style>\n');
  fprintf(oid, '    div.tab {\n');
  fprintf(oid, '      width: 90%%;\n');
  fprintf(oid, '      margin: auto;\n'); 
  fprintf(oid, '      padding-top: 30px;\n'); 
  fprintf(oid, '    }\n\n');
    
  fprintf(oid, '    .head {\n');
  fprintf(oid, '      background-color: #FFE7C6\n');                  % pink header background
  fprintf(oid, '    }\n\n');

  fprintf(oid, '    #tab {\n');
  fprintf(oid, '      border-style: solid hidden solid hidden;\n');   % border top & bottom only
  fprintf(oid, '    }\n\n');

  fprintf(oid, '    tr:nth-child(even){background-color: #f2f2f2}\n');% grey on even rows
  fprintf(oid, '  </style>\n');
  fprintf(oid, '</head>\n\n');
  fprintf(oid, '<body>\n\n');
  
  fprintf(oid, '  <div class="tab">\n');
  fprintf(oid, '  <table id="tab">\n');

  % header
  if ~isempty(header)
    fprintf(oid, '    <tr class="head">');
    for j = 1:n_cols
      fprintf(oid, ' <th>%s</th>', header{j});
    end
    fprintf(oid, ' </tr>\n\n');
  end

  % body
  for i = 1:n_rows
    fprintf(oid, '    <tr>\n      ');
    for j = 1:n_cols
      val_ij = val{i,j};
      if iscell(val_ij)
        fprintf(oid, '<td>%s</td> ', val_ij{:});
      else
        fprintf(oid, '<td>%s</td> ', val_ij);
      end
    end
    fprintf(oid, '  \n    </tr>\n\n');
  end
 
  % file tail
  fprintf(oid, '  </table>\n'); % close table
  fprintf(oid, '  </div>\n\n');

  fprintf(oid, '</body>\n');
  fprintf(oid, '</html>\n');

  fclose(oid);

  web(fileName,'-browser') % open html in systems browser
  pause(2)
  if ~save
    delete(fileName)
  end  
end

##### SOURCE END #####
--></body></html>